<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ title }} â€“ {{ male_name }} & {{ female_name }}</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <h1>{{ title }}</h1>

    <div class="names">
      <span class="name">{{ male_name }}</span>
      <span class="and">&</span>
      <span class="name">{{ female_name }}</span>
    </div>

    <div class="counts">
      <div class="card">
        <h2>{{ male_name }}</h2>
        <p class="count">{{ male_count }}</p>
        <div class="buttons">
          <button onclick="updateCount('male','done')">+1</button>
          <button onclick="updateCount('male','skip')">Skip</button>
          <button onclick="updateCount('male','cant')">Can't</button>
          <button onclick="updateCount('male','cheater')">Cheater</button>
          <button onclick="updateCount('male','injured')">Injured</button>
        </div>
      </div>

      <div class="card">
        <h2>{{ female_name }}</h2>
        <p class="count">{{ female_count }}</p>
        <div class="buttons">
          <button onclick="updateCount('female','done')">+1</button>
          <button onclick="updateCount('female','skip')">Skip</button>
          <button onclick="updateCount('female','cant')">Can't</button>
          <button onclick="updateCount('female','cheater')">Cheater</button>
          <button onclick="updateCount('female','injured')">Injured</button>
        </div>
      </div>
    </div>

    <div class="meta">
      <p>Skipped: {{ male_skipped }} / {{ female_skipped }}</p>
      <p>Can't: {{ male_cant }} / {{ female_cant }}</p>
      <p>Cheater: {{ male_cheater }} / {{ female_cheater }}</p>
      <p>Injured: {{ male_injured }} / {{ female_injured }}</p>
    </div>

    <div class="phrase" id="phrase"></div>

    <div class="footer">
      <button class="reset" onclick="resetAll()">Reset today</button>
    </div>
  </div>

<script>
async function updateCount(person, action) {
  await fetch('/update_count', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({person, action})
  });
  location.reload();
}

async function resetAll() {
  await fetch('/reset', {method: 'POST'});
  location.reload();
}

async function loadPhrase() {
  const res = await fetch('/get_phrase', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({})
  });
  const data = await res.json();
  document.getElementById('phrase').innerText = data.phrase;
}
loadPhrase();
</script>
</body>
</html>
